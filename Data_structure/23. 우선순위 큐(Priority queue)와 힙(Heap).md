## 23. 우선순위 큐(Priority queue)와 힙(Heap)

### 힙

힙은 특정한 규칙을 만족하도록 구성된 '이진 트리'입니다.

단순히 최대원소를 가능한 한 빠르게 찾을 수 있는 방법으로 설계되었습니다.

최대 힙(max heap, 가장 큰원소를 찾는 데 사용) 기준으로 살펴보겠습니다.



![heap구조](./heap구조.jpg)







#### Max heap

부모 노드가 가진 원소는 항상 자식 노드보가 가진 원소 이상입니다.

왼쪽, 오른쪽 자식은 순서가 상관이 없고, 가장 큰 원소는 항상 트리의 루트에 들어갑니다.

힙의 모양 규칙은 두 가지 조건이 필요합니다.

- 마지막 레벨을 제외한 모든 레벨에 노드가 꽉 차 있어야 한다.
- 마지막 레벨에 노드가 있을 때 왼쪽부터 순서대로 채워져 있어야 한다.



이 규칙을 만족하면, 힙의 높이는 최소가 되며 O(logN)이 됩니다.

힙이 요구하는 굉장히 엄격한 모양 규칙은 구현할 때 장점으로 작용합니다.

*트리에 포함된 노드의 개수만 알면, 트리 전체의 구조를 알 수 있기 때문입니다.*



#### heap 구현

```c++
vector<int> heap;
```

- a[i] 의 왼쪽 자손은 a[2*i + 1] 입니다.

- a[i]의 오른쪽 자손은 a[2*i + 2] 입니다.

- a[i]의 부모는 a[(i-1) / 2] 입니다.



#### head에 원소 삽입

```c++
void insert(vector<int> & heap, int x){
    // heap 배열에 가장 마지막에 원소 삽입
    heap.push_back(x);
    
    int idx = heap.size() - 1;
    int parent_idx = (idx - 1) / 2;

    // Re-heap-up : 부모에 더 큰 원소가 없을 때 까지 위로 올림
    while(idx > 0 && heap[parent_idx] < heap[idx]){
        swap(heap[idx], heap[(parent_idx)]);
        idx = parent_idx;
    }
}
```



