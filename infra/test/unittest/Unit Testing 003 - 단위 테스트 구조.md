# Unit Testing 003 - 단위 테스트 구조





- 준비, 실행, 검증
- arrange, act, assert (AAA 패턴)
- given, when, then : 비기술자에게 더 읽히기 쉬우므로 공유하는 테스트에 적합하다.



# 1 단위 테스트를 구성하는 방법

## 1 AAA 패턴 사용

- 준비 구절에서는 테스트 대상 시스템 (SUT, System Under Test) 과 해당 의존성을 원하는 상태로 만든다.
- 실행 구절에서는 SUT에서 메서드를 호출하고, 준비된 의존성을 전달하며 출력 값을 캡처한다.
- 검증 구절에서는 결과를 검증한다. 결과는 반환값이나 SUT와 협력자의 최종상태, SUT가 협력자에 호출한 메서드 등으로 표시할 수 있다.





## 2 여러 개의 준비, 실행, 검증 구절 피하기



## 3 테스트 내 if 문 피하기

- 유지비만 불어난다.

## 4 구절은 얼마나 커야 하는가

- 준비 구절
  - 코드 재사용에 도움되는 두가지 패턴
    - Object Mother
    - Test Data Builder




## 5 검증 구절에는 검증문을 적당히



## 6 종료 단계

- 준비, 실행, 검증 이후 종료구절을 구분하기도 한다.
- 테스트로 생긴 파일 삭제, DB 연결 종료 등



## 7 테스트 대상 시스템 구별하기

## 8 준비, 실행, 검증 주석 제거하기



---

# 2 xUnit 테스트 프레임워크

- 깨끗하고 간결



# 3 테스트 간 테스트 픽스처 재사용

- 준비 구절에서 코드를 재사용하는 것 = 테스트를 줄이면서 단순화



> 텍스트 픽스처
>
> - **테스트 실행 대상 객체. SUT로 전달되는 인수**
> - NUnit 에서 테스트가 포함된 클래스를 표시하는 특성이다.



테스트 픽스처 구성을 전부 또는 대부분 제거할 수 있다. 하지만 단점

- 테스트 간 결합도 높아지고
- 테스트 가독성 낮아진다.

## 1 테스트 간 높은 결합도는 안티 패턴

## 2 테스트 가독성을 떨어뜨리는 생성자 사용

## 3 더 나은 텍스트 픽스처 재사용법

- 테스트 클래스에 비공개 팩토리 메서드 두기





# 4 단위 테스트 명명법

- 테스트 대상 메서드
- 시나리오
- 예상결과

말고



간단하고 쉬운 영어 구문이 효과적

- sum_of_two_numbers()





# 5 매개변수화된 테스트 리팩토링 하기

# 6 검증문 라이브러리를 사용한 테스트 가독성 향상

- Fluent Assertions 라이브러리 등

