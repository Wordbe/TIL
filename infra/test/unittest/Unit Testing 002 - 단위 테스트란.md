# Unit Testing 002 - 단위 테스트란





# 1 단위테스트 정의

- 작은 코드 조각(단위)을 검증하고
- 빠르게 수행하고
- 격리된 방식으로 처리하는 자동화된 테스트



## 격리 문제에 대한 런던파의 접근

- 고전파 대표 책은 켄트 백의 '테스트 주도 개발'
- 런던파는 mockist (목 추종자) 라고 불리며, Grwoing Object-Oriented Software 가 유명



- 코드 조각을 격리하여 검증한다는 것은 
  - 테스트  대상 시스템을 협력자 (collaborator) 에서 격리하는 것을 말한다.
- 하나의 클래스가 다른 클래스에 의존하면, 의존성을 테스트 대역 (test double) 으로 대체해야 한다.
  - 외부 영향과 분리하여 테스트 대상 클래스에만 집중한다.



고전적 스타일

3단 구성

- 준비, 실행, 검증 (AAA, Arrange Act Assert)



준비 단계

- 테스트 대상 시스템 (SUT, System Under Test)과 하나의 협력자를 준비한다.



> 목은 테스트 대상 시스템과 협력자 간의 상호 작용을 검사할 수 있는 테스트 대역이다.



> 공유 의존성 (shared dependency)
>
> - 테스트 간 공유되고 서로 결과에 영향을 미칠 수 있는 수단을 제공하는 의존성
> - 예) 정적 가변 필드 (static mutable field)
>
> 비공개 의존성 (private dependency)
>
> - 공유하지 않는 의존성
>
> 프로세스 외부 의존성 (out-of-process dependency)
>
> - 애플리케이션 실행 프로세스 외부에서 실행되는 의존성, 아직 메모리에 없는 데이터에 대한 프록시이다.



# 3 고전파와 런던파 비교

고전파 선호

- 단위 테스트 목표인 프로젝트의 지속 가능한 성장을 달성하는 데 더 적합
- 목을 사용하는 테스트는 불안정하다.

## 한 번에 한 클래스만 테스트하기

## 상호 연결된 클래스의 큰 그래프를 단위 테스트하기

## 버그 위치 정확히 찾아내기

## 차이점

- 테스트 주도 개발 (TDD) 을 통한 시스템 설계 방식
  - 런던 스타일 하향식 TDD, 목 사용
  - 고전 스타일 상향식
- 과도한 명세 (over-specification) 문제
  - 런던 스타일은 구현체가 자주 결합된다. 목을 전반적으로 아무 데나 써서 문제가 생길 수 있다.



# 4 두 분파의 통합 테스트



고전파의 관점에서 단위테스트

- 단일 동작 단위를 검증하고
- 빠르게 수행하고
- 다른 테스트와 별도로 처리한다.



> 엔드 투 엔드 테스트
>
> - 일반적으로 프로세스 외부 의조성을 모두 포함한다. 통합 테스트는 이러한 의존성을 한가지(또는 두가지)만 확인한다. 즉, 데이터베이스나 파일 시스템과 같이 자동으로 설정하기 쉬운 의존성에 해당한다.
> - 비용이 많이든다.
> - 모든 단위 테스트와 통합 테스트를 통과한 후 빌드 프로세스 후반에 실행하는 것이 좋다.
> - 개발자 머신이 아닌 빌드 서버에서만 실행할 수도 있다.
> - 통합 테스트와 엔드 투 엔드 테스트 사이 뚜렷한 경계가 없을 수도 있다.







