# MSA 001 - Monolith, Microservice

- FTGO - 미국 온라인 음식 배달회사
- 애플리케이션
  - 대금지급 - Stripe
  - 메시지 전송 - Twilio
  - 이메일 발송 - AWS SES(Simple Email Service)

![](https://i.ibb.co/2gkDx9L/image.png)



# 1 모놀리식 지옥

- 복잡해서 변경하기 어렵다
- 개발이 더디다
- 커밋부터 배포, 테스트 주기가 길다
- 확장하기 어렵다.
- 신뢰성이 부족하다.
- 새로운 기술 도입이 어렵다.
  - Go
  - Node.js
  - Non JVM



# 4 마이크로서비스 아키텍처

![](https://i.ibb.co/ftzjZct/image.png)

- X축 확장 : 다중 인스턴스에 고루 분산
  - 가용성 향상
  - 로드밸런서 적용
- Z축 확장 : 데이터 분할 (요청 속성별 라우팅)
  - 파티셔닝
  - 인스턴스 앞면에 위치한 라우터는 요청 속성에 맞게 인스턴스 요청 라우팅
- Y축 확장 : 기능에 따라 애플리케이션을 서비스로 분해
  - 각 서비스가 집중된, 응집된 책임을 맡음

# 5 MSA장단점

장점

- 크고 복잡한 애플리케이션을 지속적으로 전달/배포할 수 있다.
- 서비스 규모가 작아 관리하기 쉽다.
- 서비스를 독립적으로 배포/확장한다.
- 팀이 자율적으로 움직인다.
- 결함 격리가 쉽다.
- 새로운 기술을 실험하고 도입하기 쉽다.

단점

- 딱 맞는 서비서를 찾기 어렵다.
- 분산 시스템이 복잡해서 개발, 테스트, 배포가 어렵다.
- 여러 서비스에 걸친 기능을 배포할 때 잘 조정해야 한다.
- MSA 도입 시점을 결정하기 어렵다.

# 6 MSA 패턴 언어

패턴 계층

- 애플리케이션 패턴
- 애플리케이션 인프라 패턴
- 인프라 패턴

- 애플리케이션을 여러 서비스로 분해하는 패턴
- 통신 패턴
- 트랜잭션 관리를 위한 데이터 일관성 패턴
  - 트랜잭셔널 메시징
  - 통신 스타일
  - 디스커버리
- 데이터 쿼리 패턴
  - API 조합 패턴
  - CQRS
- 서비스 배포 패턴
- 관측성 패턴 : 애플리케이션 동작파악
  - health check
  - log aggregation
  - 분산 추적 (distributed tracing)
  - 예외 추적 (exception tracking)
  - 애플리케이션 지표 (application metrics)
  - 감사 로깅 (audit logging) : 사용자가 한 일 기록
- 서비스 테스트 자동화 패턴
  - 컨슈머 주도 계약 테스트
  - 컨슈모 쪽 계약 테스트
  - 서비스 컴포넌트 테스트
- 횡단 관심사 처리 패턴
  - 마이크로서비스 섀시 (Microservice Chassis) 패턴
- 보안 패턴
  - JWT









